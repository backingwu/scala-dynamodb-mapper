language: java

jdk:
  - oraclejdk8

before_install:
  - openssl aes-256-cbc -K $encrypted_9b6d7f75eb61_key -iv $encrypted_9b6d7f75eb61_iv -in .build/secret.asc.enc -out .build/secret.asc -d
  - gpg --allow-secret-key-import --import ./build/secret.asc
  - find . -type f -print0 | xargs -0 sed -i "s/DYNAMIC-SNAPSHOT/0.1.${TRAVIS_BUILD_NUMBER}-SNAPSHOT/g"
  - mkdir /tmp/dynamodb
  - curl -o dynamodb.tar.gz -L http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest
  - tar zxf dynamodb.tar.gz --directory /tmp/dynamodb
  - java -Djava.library.path=/tmp/dynamodb/DynamoDBLocal_lib -jar /tmp/dynamodb/DynamoDBLocal.jar -inMemory &

install: "mvn install -Dmaven.javadoc.skip=true -Pci -B -V"

script: true
